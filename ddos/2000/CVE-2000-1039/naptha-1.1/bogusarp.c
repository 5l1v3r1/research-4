/* bogusarp.c v1.1 */
/* copyright 2000 Bob Keyes */
/* all rights reserved */ 

#include <libnet.h>

int main(int argc,char **argv){
char arp_buf[128];
int sleep=6000000;
static struct libnet_link_int *link_struct_ptr;

static	u_int32_t ip_src_addr;
static	u_char enet_bcast[6] = {0xff,0xff,0xff,0xff,0xff,0xff};
	u_char eth_src_addr[6]={0x00,0xc0,0x00,0xff,0x00,0xee};
	u_char eth_dst_addr[6]={0x00,0x00,0x00,0x00,0x00,0x00};
u_char ip_dst_addr[4]={0xc0,0xa8,0x7c,0x7c};
	u_char device[8];
static char errbuf[256];

if (argc < 1) printf("Usage: %s ip-address device\n",argv[0]);
ip_src_addr=inet_addr(argv[1]);

strncpy(device,argv[2],8);

link_struct_ptr=libnet_open_link_interface((char *)&device,errbuf);

libnet_build_ethernet(enet_bcast,eth_src_addr,ETHERTYPE_ARP,NULL,0,arp_buf);


libnet_build_arp(ARPHRD_ETHER, ETHERTYPE_IP, ETHER_ADDR_LEN, 
4, ARPOP_REQUEST, eth_src_addr,
(u_char *)&ip_src_addr, eth_dst_addr, ip_dst_addr, NULL, 0, arp_buf +
LIBNET_ETH_H);

while(1)
 {
 libnet_write_link_layer(link_struct_ptr,(char *)&device,arp_buf,
LIBNET_ARP_H + LIBNET_ETH_H);
 usleep(sleep);
 }
}
