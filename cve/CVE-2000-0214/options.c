/* 
 * $Id: options.c,v 1.1 2010-11-17 16:12:33-02 nbrito Exp $ 
 */

 /* ------------------x------------------x------------------x------------------
 * Author: Nelson Brito <nbrito[at]sekure[dot]org>
 *
 * Copyright (c) 2000-2010 Nelson Brito. All rights reserved worldwide.
 *
 * This file is part of Penetration Test Toolkit.
 * ------------------x------------------x------------------x------------------
            FTPx FTP Explorer Weak Password Encryption Vulnerability
                                  Release 2.00

                      Copyright (c) 2000-2010 Nelson Brito
                               All Rights Reserved
   ------------------x------------------x------------------x------------------ */
#ifndef OPTIONS_C__
#define OPTIONS_C__ 1
/* @AUTHOR:	  Nelson Brito
   @REVISION: February 25th, 2000
			  October  20th, 2008
			  November 17th, 2010 */
#include "common.h"

/* Options processing routine. */
struct options process_options(int argc, char ** argv){
	int lineopt;
	/* Command-line options structure. */
	struct options o = {
		DEFAULT_LENGHT,		/* default is 10 */
		DEFAULT_RATIO,		/* default is 3  */
		DEFAULT_INCREMENT,	/* default is 9  */
	};

   	while(1){
		if((lineopt = getopt(argc, argv, "l:r:i:h?")) == EOF)
			break;

		switch(lineopt){
              case 'l':
                    o.l = atoi(optarg);
                    break;
              case 'r':
                    o.r = atoi(optarg);
                    break;
              case 'i':
                    o.i = atoi(optarg);
                    break;
			case 'h':
			case '?':
				usage(program, author, email);
				break;
			default:
				printf("type \"%s -h\" for further information\n", program);
				exit(EXIT_FAILURE);
				break;
        }
	}

	argc -= optind;
	argv += optind;

	return(o);
}
#endif  /* OPTIONS_C__ */
