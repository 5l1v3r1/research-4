/* 
 * $Id: ftpx.c,v 1.1 2010-11-17 16:12:33-02 nbrito Exp $ 
 */

 /* ------------------x------------------x------------------x------------------
 * Author: Nelson Brito <nbrito[at]sekure[dot]org>
 *
 * Copyright (c) 2000-2010 Nelson Brito. All rights reserved worldwide.
 *
 * This file is part of Penetration Test Toolkit.
 * ------------------x------------------x------------------x------------------
            FTPx FTP Explorer Weak Password Encryption Vulnerability
                                  Release 2.00

                      Copyright (c) 2000-2010 Nelson Brito
                               All Rights Reserved
   ------------------x------------------x------------------x------------------ */
#ifndef FTPX_C__
#define FTPX_C__ 1
/* @AUTHOR:	  Nelson Brito
   @REVISION: February 25th, 2000
			  October  20th, 2008
			  November 17th, 2010 */
#include "common.h"

/* Emulates the FTPx Encryption Engine. */
#define R2(r, i, x, y) ((x + i) + (y * r))

/* Calculate the password.
   Prints the current character in main(). */
void ftpx(unsigned int x, unsigned int y, struct options z){ /* X, Y, Z? 8-D */
	while(x < 127){ 
		/* Printing the first line. */
		if(x == 33)
			printf("Char\t");
		/* Complementing the first line. */
		if(x == 33)
			for(y = 0 ; y <= z.l ; y++)
				if(y == z.l)
					printf("\n");
				else
					printf("P#%02d\t", y + 1);
		/* The character is printed first, and then the hexadecimal 
		   values are printed for each new position in the password. */
		printf("%c\t", (char)x);
		for(y = 0 ; y < z.l ; y++)
			printf("0x%02x\t", R2(z.r, z.i, x, y));
		printf("\n");
		x++; 
	}
}
#endif  /* FTPX_C__ */
